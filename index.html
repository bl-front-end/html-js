<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>精选篮筐-商品列表</title>
<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0, user-scalable=no"/>
<link href="css/css/base.css" rel="stylesheet" type="text/css"/>
<link href="css/css/common.css" rel="stylesheet" type="text/css"/>

<script src="js/jquery-2.1.3.min.js"></script>
<script src="js/jquery.fly.min.js"></script>
<script src="js/touchslider.dev.js"></script>
<script>
$(function() { 
    var offset = $(".basket-foot-logo").offset(); 
    $(".icon-add").click(function(event){ 
        var addcar = $(this); 
        var img = addcar.parent().parent().find('img').attr('src'); 
        var flyer = $('<img class="u-flyer" src="'+img+'">'); 
        flyer.fly({ 
            start: { 
                left: event.pageX-50, //开始位置（必填）#fly元素会被设置成position: fixed 
                top: event.pageY-50 //开始位置（必填） 
            }, 
            end: { 
                left: offset.left, //结束位置（必填） 
                top: offset.top+70, //结束位置（必填） 
                width: 0, //结束时宽度 
                height: 0 //结束时高度 
            },       
        }); 
    }); 
}); 
$(function(){
	$("#leftMenu li").click(function(){
		$(this).siblings().removeClass("selected");	
		$(this).addClass("selected");
		$("#sortList ul").hide().eq($(this).index()).show();
	});
	$(".basket-foot-logo").click(function(){
		if($(".basket-popup").attr("class").indexOf("basket-popup-show") > 0){
			$(".basket-popup").removeClass("basket-popup-show");
			$(".basket-shade").hide();
		}else{
			$(".basket-popup").addClass("basket-popup-show");
			$(".basket-shade").show();
			
		}
	});
	$(".basket-foot-logo span").hide();
	//篮筐有无商品检查：若没有则隐藏数字
	var basketspanchange=function(){
		if(parseFloat($(".basket-foot-logo span").text())>0){
			$(".basket-foot-logo span").show();
		}else{
			$(".basket-foot-logo span").hide();
		}
	};
	//带￥金额格式化
	var fmtmoney=function(money){
		return money=parseFloat(money.substring(1,money.length));
	}
	var compumoney=function(money){
		money=fmtmoney(money);
		$(".basket-foot-logo span").text(parseInt($(".basket-foot-logo span").text())+1);
		var totalmoney=$(".basket-foot-money label").text();
		totalmoney=fmtmoney(totalmoney)+money;
		$(".basket-foot-money label").text("￥"+totalmoney.toFixed(2));
		basketspanchange();	
	}
	$(".basket-lefmenu ul li").click(function(){
		var num=$(".basket-lefmenu ul li").index($(this))+1;
		var scroll_offset = $(".basket-list ul:nth-child("+num+")").offset().top; 
		var scroll_offset2 = $(".basket-list ul:first-child").offset().top; 		//得到div层的offset，包含两个值，top和left
		$(".basket-list").animate({
			scrollTop:scroll_offset-scroll_offset2  //让ul的scrollTop等于pos的top，就实现了滚动
		},1000);
	});
	$(".basket-list ul li").on("touchmove ",function(){
		var height=$(".basket-list").scrollTop()+$(".basket-list").height()-$(".basket-list ul li").height();
		var menumlength=$(".basket-lefmenu ul li").length;
		for(var i=1;i<=menumlength;i++){
			
			var comparelength = $(".basket-list ul:nth-child("+i+")").offset().top-$(".basket-list ul:first-child").offset().top;
			if(i!=menumlength){
				var j=i+1;
				var comparelength2= $(".basket-list ul:nth-child("+j+")").offset().top-$(".basket-list ul:first-child").offset().top;
				if(height>=comparelength&&height<comparelength2){
					$(".basket-lefmenu ul li").delay("slow").removeClass("selected ");
					$(".basket-lefmenu ul li:nth-child("+i+")").delay("slow").addClass("selected");		
				}	
			}else{
				if(height>=comparelength){
					$(".basket-lefmenu ul li").delay("slow").removeClass("selected ");
					$(".basket-lefmenu ul li:nth-child("+i+")").delay("slow").addClass("selected");			
				}	
			}
		}
	});
	$(".icon-minus").parent().prev().hide();
	$(".icon-minus").parent().hide();
	$(".icon-minus").click(function(){
		var num=$(".basket-list li").index($(this).parent().parent());
		var temp=$(".basket-popup ul li[index="+num+"]").find("div.popup-list-money:last-child .leftminus .popup-list-compute");
		temp.click();
	});
	$(".icon-add").click(function(){
		var money=$(this).parent().prev().text();
		var num=$(".basket-list li").index($(this).parent().parent());
		var addressnum=$(".basket-popup ul li").index($(".basket-popup ul li[index="+num+"]"));
		
		var mainpagenum=$(this).parent().next().find(".basket-buy-num");//主列表上面的数字渲染
		mainpagenum.text(parseInt(mainpagenum.text())+1);
		if(parseInt(mainpagenum.text())>0){
			$(this).parent().next().show();
			$(this).parent().next().next().show();
			
		}
		if(addressnum==-1){
			//如果上弹框没有目标信息则新增渲染
			var listli="<li><div class='popup-list-intr'>索尼(SONY)KDL-50W 700B 50英寸全高清LED</div><div class='popup-list-money'><span class='money-color'>￥990</span></div><div class='popup-list-money'><div class='leftminus'><label class='popup-list-compute'>-</label></div><span>1</span><div class='fr  '><label class='popup-list-compute'>+</label></div></li>";
			$(".basket-popup ul ").append(listli);
			//上弹框加减号绑定事件添加
			$(".basket-popup li:last-child  .popup-list-compute").click(function(){
				var money=$(this).parent().parent().prev().find("span").text();
				money=fmtmoney(money);
				var totalmoney=$(".basket-foot-money label").text();
				totalmoney=fmtmoney(totalmoney);
				if($(this).parent().hasClass("fr")){//加号
					//if(parseInt($(this).parent().prev().text())+1<=10){//限购数目添加
						$(this).parent().prev().text(parseInt($(this).parent().prev().text())+1);
						$(".basket-foot-logo span").text(parseInt($(".basket-foot-logo span").text())+1);
						$(".basket-foot-money label").text("￥"+(totalmoney+money).toFixed(2));
						
						var a=$(".basket-list li").eq(num).find("div.fr .basket-buy-num");
						a.text(parseInt(a.text())+1);
					//}
				}else{//减号
					if(parseInt($(this).parent().next().text())>0){
						if(parseInt($(this).parent().next().text())-1==0){
							$(this).parent().parent().parent().remove();
							
							var b=$(".basket-list li").eq(num).find("div.fr .basket-buy-num");
							b.parent().hide();
							b.parent().next().hide();
							if($(".basket-popup li").length==0){
								$(".basket-popup").removeClass("basket-popup-show");
								$(".basket-shade").hide();
							}
							
						}
						$(this).parent().next().text(parseInt($(this).parent().next().text())-1);
						$(".basket-foot-logo span").text(parseInt($(".basket-foot-logo span").text())-1);
						$(".basket-foot-money label").text("￥"+(totalmoney-money).toFixed(2));
						
						var a=$(".basket-list li").eq(num).find("div.fr .basket-buy-num");
						a.text(parseInt(a.text())-1);
					}
				}
				basketspanchange();
			});
			//内容替换
			$(".basket-popup li:last-child").attr("index",num);//在上弹框列表li的index上给出主列表的index保持一致用于定位
			var temp=$(this).parent().parent();
			$(".basket-popup li:last-child").find("div.popup-list-intr ").text(temp.find("div.basket-list-firstd label").text());
			$(".basket-popup li:last-child").find(" span.money-color").text(temp.find("p.basket-list-thirdp").text());			
			compumoney(money);				
		}else{
			var temp=$(".basket-popup ul li[index="+num+"]").find("div.popup-list-money:last-child span");
			//if(parseInt(temp)+1<=10){//限购条件
				temp.text(parseInt(temp.text())+1);
				compumoney(money);
			//}
		}
	});
	
})

</script>
</head>
<body class="new">
 <div class="subHeader">
  <a href="#" class="aback iconfont icon-back"></a>
  <h2>积分明细</h2>
 </div>
  <div class='basket-top'>
    <div ><img src="images/icon/baskettop.png" ></div>
    <span>买满3件不同分组商品，享受8折优惠</span>
  </div>
  <div class=" bootfixsize">
   <div class="leftMenu basket-lefmenu" id="leftMenu">
      <ul >
        <li class="selected">分组一</li>
        <li>分组二</li>
        <li>分组三</li>
        
      </ul>
    </div>
    <div class=" basket-list " id="">
      <ul>
        <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
		   <div class="fr  "><label class="basket-buy-num">0</label></div>
		  
		  <div class="fr  "><label class="cartCheckbox proAdd iconfont icon-minus"></label></div>
        </li>
		 <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
		   <div class="fr  "><label class="basket-buy-num">0</label></div>
		  
		  <div class="fr  "><label class="cartCheckbox proAdd iconfont icon-minus"></label></div>
        </li>
		 <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
		   <div class="fr  "><label class="basket-buy-num">0</label></div>
		  
		  <div class="fr  "><label class="cartCheckbox proAdd iconfont icon-minus"></label></div>
        </li>
		 <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
		  <div class="fr  "><label class="basket-buy-num">0</label></div>
		  
		  <div class="fr  "><label class="cartCheckbox proAdd iconfont icon-minus"></label></div>
        </li>
		 <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
		   <div class="fr  "><label class="basket-buy-num">0</label></div>
		  
		  <div class="fr  "><label class="cartCheckbox proAdd iconfont icon-minus"></label></div>
        </li>
		 <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
		   <div class="fr  "><label class="basket-buy-num">0</label></div>
		  
		  <div class="fr  "><label class="cartCheckbox proAdd iconfont icon-minus"></label></div>
        </li>
		 <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
		   <div class="fr  "><label class="basket-buy-num">0</label></div>
		  
		  <div class="fr  "><label class="cartCheckbox proAdd iconfont icon-minus"></label></div>
        </li>
		 <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
		   <div class="fr  "><label class="basket-buy-num">0</label></div>
		  
		  <div class="fr  "><label class="cartCheckbox proAdd iconfont icon-minus"></label></div>
        </li>
      </ul>
	  
        <ul>
        <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
		   <div class="fr  "><label class="basket-buy-num">0</label></div>
		  
		  <div class="fr  "><label class="cartCheckbox proAdd iconfont icon-minus"></label></div>
        </li>
		 <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
        </li>
		 <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
        </li>
		 <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
        </li>
		 <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
        </li>
		 <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
        </li>
		 <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
        </li>
      </ul>
       <ul>
         <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
        </li>
		 <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
        </li>
		 <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
        </li>
		 <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
        </li>
		 <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
        </li>
		 <li>
          <a href="####">
            <img src="images/new-active-index/vegetable-1.jpg">
            <div class='basket-list-firstd'><label>索尼(SONY)KDL-50W 700B 50英寸全高清LED</label><div class='intro-like'>猜你喜欢</div></div>
            <p class='basket-list-secondp'>每单限购<label>10件</label></p>
          </a>
		  <p class='basket-list-thirdp'>￥990.00</p>
		  <div class="fr  fr-margin "><label class="cartCheckbox proAdd iconfont icon-add"></label></div>
        </li>
      </ul>
	  
      
    </div>
  </div>
<div class="basket-foot-fix">
	  <div class='basket-foot-logo'><img src='images/icon/basketfootlogo.png' width="100%"><span>0</span></div>
	  <div class="basket-foot-money"><span>￥350.00</span><br><p class='font-color-ash3 coupon-calculate'>优惠计算中...</p><!--<label>￥0.00</label>--></div>	
	  <a class='color-control-one'>立即下单</a>
	  <a class='color-control-two'>加入购物车</a>
	  
	 
	 
</div>
<div class='basket-popup'>
	<div class='basket-popup-top'>满额减：当满足了购物车的食量，那么就会有减免</div>
	<ul>
	<!--<li index='1'>
		<div class='popup-list-intr'>索尼(SONY)KDL-50W 700B 50英寸全高清LED</div>
		<div class='popup-list-money'><span class='money-color'>￥990</span></div>
		<div class='popup-list-money'> 
			<div class="leftminus"><label class="popup-list-compute	">-</label></div>
			<span >0</span>
			<div class="fr  fr-margin"><label class="popup-list-compute">+</label></div>
		
		</div>
	</li>
	<li index='0'>
		<div class='popup-list-intr'>HHHHHHHHHHHHHHHHHHHHHHHHHHHHH</div>
		<div class='popup-list-money'><span class='money-color'>￥990</span></div>
		<div class='popup-list-money'> 
			<div class="leftminus"><label class="popup-list-compute	">-</label></div>
			<span >0</span>
			<div class="fr  fr-margin"><label class="popup-list-compute">+</label></div>
		
		</div>
	</li>
	<li>
		<div class='popup-list-intr'>索尼(SONY)KDL-50W 700B 50英寸全高清LED</div>
		<div class='popup-list-money'><span class='money-color'>￥990</span></div>
		<div class='popup-list-money'> 
			<div class="leftminus"><label class="popup-list-compute	">-</label></div>
			<span >0</span>
			<div class="fr  fr-margin"><label class="popup-list-compute">+</label></div>
		
		</div>
	</li>
	<li>
		<div class='popup-list-intr'>索尼(SONY)KDL-50W 700B 50英寸全高清LED</div>
		<div class='popup-list-money'><span class='money-color'>￥990</span></div>
		<div class='popup-list-money'> 
			<div class="leftminus"><label class="popup-list-compute	">-</label></div>
			<span >0</span>
			<div class="fr  fr-margin"><label class="popup-list-compute">+</label></div>
		
		</div>
	</li>-->
	
	</ul>
</div>
 <div class="basket-shade" ></div>
</body>
</html>
